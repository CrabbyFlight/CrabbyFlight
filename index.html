<!-- /index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>CrabbyFlight</title>

  <!-- PWA manifest (absolute path avoids subpath issues on iOS) -->
  <link rel="manifest" href="/manifest.json">

  <!-- Icons -->
  <link rel="icon" type="image/png" sizes="192x192" href="/logo192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/logo512.png">
  <link rel="apple-touch-icon" href="/logo512.png">

  <!-- Theme -->
  <meta name="theme-color" content="#1d1f22" />
  <meta name="application-name" content="CrabbyFlight" />

  <!-- iOS PWA essentials -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-title" content="CrabbyFlight" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="format-detection" content="telephone=no" />

  <style>
    /* Minimal, stable baseline for splash and first paint */
    :root { color-scheme: dark; }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; }
    body {
      background: #1d1f22;
      color: #fff;
      font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      display: grid;
      place-items: center;
      padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
    }
    .wrap { text-align: center; max-width: 720px; padding: 24px; }
    .logo { width: 96px; height: 96px; display: block; margin: 0 auto 16px; }
    .title { font-size: clamp(28px, 4vw, 40px); font-weight: 700; margin: 0 0 6px; }
    .sub { opacity: .8; margin: 0 0 20px; }
  </style>
</head>
<body>
  <main class="wrap" role="main">
    <img class="logo" src="/logo192.png" width="96" height="96" alt="CrabbyFlight logo">
    <h1 class="title">CrabbyFlight</h1>
    <p class="sub">Fast, installable, iOS-friendly PWA shell.</p>
    <noscript>JavaScript is required.</noscript>
  </main>

  <script>
    // Add body class when running as an installed app (avoids odd flashes)
    function syncDisplayMode() {
      const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
      document.documentElement.classList.toggle('pwa', isStandalone);
    }
    syncDisplayMode();
    window.matchMedia('(display-mode: standalone)').addEventListener?.('change', syncDisplayMode);

    // Safe SW registration at root; failure is OK (e.g., file not present)
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').catch(() => {}); // why: keep scope '/', avoid subpath SW bugs on iOS
      });
    }
  </script>
</body>
</html>
